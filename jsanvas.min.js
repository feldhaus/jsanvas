function Vector2(t,e){this.x=t||0,this.y=e||0}function DisplayObject(t,e){Vector2.call(this,t||0,e||0),this.visible=!0,this.rotation=0,jsanvas.displayObjects.push(this)}function ShapeObject(t,e){DisplayObject.call(this,t,e),this.fillStyle="white",this.strokeStyle="black",this.lineWidth=1}function Group(t,e){this.children=[],DisplayObject.call(this,t,e),this._x=t||0,this._y=e||0,this._visible=!0}function Rect(t,e,i,n){ShapeObject.call(this,t,e),this.width=i,this.height=n}function Circle(t,e,i){ShapeObject.call(this,t,e),this.radius=i}function Line(){ShapeObject.call(this),this.lineWidth=1,this.fillStyle=null,this.points=[];for(var t=0;t<arguments.length;t+=2)this.points.push(new Vector2(arguments[t],arguments[t+1]))}function Img(t,e,i,n,s){DisplayObject.call(this,e,i),this.width=n||0,this.height=s||0,parent=this,this.img=new Image,this.img.src=t,this.img.onload=function(){0==parent.width&&(parent.width=parent.img.width),0==parent.height&&(parent.height=parent.img.height),parent.render()}}const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;var jsanvas={};jsanvas.displayObjects=[],Object.defineProperty(jsanvas,"canvasID",{set:function(t){this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d")}}),Object.defineProperty(jsanvas,"center",{get:function(){return new Vector2(this.width/2,this.height/2)}}),Object.defineProperty(jsanvas,"width",{get:function(){return this.canvas.width}}),Object.defineProperty(jsanvas,"height",{get:function(){return this.canvas.height}}),jsanvas.render=function(){this.context.clearRect(0,0,this.width,this.height);for(var t=0;t<this.displayObjects.length;t++)this.displayObjects[t].visible&&this.displayObjects[t].render()},jsanvas.remove=function(t){var e=this.displayObjects.indexOf(t);-1!=e&&this.displayObjects.splice(e,1)},Vector2.prototype={add:function(t){return t instanceof Vector2?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=t),this},sub:function(t){return t instanceof Vector2?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=t),this},mult:function(t){return t instanceof Vector2?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},div:function(t){return t instanceof Vector2?(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=t),this},equals:function(t){return this.x==t.x&&this.y==t.y},angleTo:function(t){return Math.atan2(t.y-this.y,t.x-this.x)},sqrDistance:function(t){return Vector2.sub(this,t).sqrMagnitude},distance:function(t){return Math.sqrt(this.sqrDistance(t))},clone:function(){return new Vector2(this.x,this.y)},toString:function(){return"Vector2 ("+this.x+", "+this.y+") "}},Object.defineProperty(Vector2.prototype,"sqrMagnitude",{get:function(){return this.x*this.x+this.y*this.y}}),Object.defineProperty(Vector2.prototype,"magnitude",{get:function(){return Math.sqrt(this.sqrMagnitude)}}),Object.defineProperty(Vector2.prototype,"normalized",{get:function(){var t=this.magnitude;return t>0?this.clone().div(t):Vector2.zero}}),Vector2.add=function(t,e){return e instanceof Vector2?new Vector2(t.x+e.x,t.y+e.y):new Vector2(t.x+e,t.y+e)},Vector2.sub=function(t,e){return e instanceof Vector2?new Vector2(t.x-e.x,t.y-e.y):new Vector2(t.x-e,t.y-e)},Vector2.mult=function(t,e){return e instanceof Vector2?new Vector2(t.x*e.x,t.y*e.y):new Vector2(t.x*e,t.y*e)},Vector2.div=function(t,e){return e instanceof Vector2?new Vector2(t.x/e.x,t.y/e.y):new Vector2(t.x/e,t.y/e)},Vector2.angleBetween=function(t,e){return t.angleTo(e)},Object.defineProperty(Vector2,"zero",{get:function(){return new Vector2}}),DisplayObject.prototype=Object.create(Vector2.prototype),DisplayObject.prototype.removeSelf=function(){jsanvas.remove(this)},DisplayObject.prototype.toBack=function(){this.removeSelf(),jsanvas.displayObjects.unshift(this)},DisplayObject.prototype.toFront=function(){this.removeSelf(),jsanvas.displayObjects.push(this)},DisplayObject.prototype.render=function(){},ShapeObject.prototype=Object.create(DisplayObject.prototype),ShapeObject.prototype.draw=function(){this.fillStyle&&(jsanvas.context.fillStyle=this.fillStyle,jsanvas.context.fill()),this.lineWidth>0&&(jsanvas.context.lineWidth=this.lineWidth,jsanvas.context.strokeStyle=this.strokeStyle,jsanvas.context.stroke())},Group.prototype=Object.create(DisplayObject.prototype),Group.prototype.insert=function(t){t instanceof DisplayObject&&(this.children.push(t),t.x+=this.x,t.y+=this.y)},Object.defineProperty(Group.prototype,"x",{set:function(t){this._x=t;for(var e=0;e<this.children.length;e++)this.children[e].x+=t},get:function(){return this._y}}),Object.defineProperty(Group.prototype,"y",{set:function(t){this._y=t;for(var e=0;e<this.children.length;e++)this.children[e].y+=t},get:function(){return this._y}}),Object.defineProperty(Group.prototype,"visible",{set:function(t){this._visible=t;for(var e=0;e<this.children.length;e++)this.children[e].visible+=t}}),Rect.prototype=Object.create(ShapeObject.prototype),Rect.prototype.render=function(){jsanvas.context.save(),jsanvas.context.translate(this.x,this.y),jsanvas.context.rotate(this.rotation*DEG2RAD),jsanvas.context.beginPath(),jsanvas.context.rect(-this.width/2,-this.height/2,this.width,this.height),this.draw(),jsanvas.context.restore()},Circle.prototype=Object.create(ShapeObject.prototype),Circle.prototype.render=function(){jsanvas.context.beginPath(),jsanvas.context.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.draw()},Line.prototype=Object.create(ShapeObject.prototype),Line.prototype.render=function(){if(jsanvas.context.beginPath(),this.points.length>1){jsanvas.context.moveTo(this.points[0].x,this.points[0].y);for(var t=1;t<this.points.length;t++)jsanvas.context.lineTo(this.points[t].x,this.points[t].y)}this.draw()},Line.prototype.append=function(){for(var t=0;t<arguments.length;t+=2)this.points.push(new Vector2(arguments[t],arguments[t+1]))},Img.prototype=Object.create(DisplayObject.prototype),Img.prototype.render=function(){jsanvas.context.save(),jsanvas.context.translate(this.x,this.y),jsanvas.context.rotate(this.rotation*DEG2RAD),jsanvas.context.drawImage(this.img,-this.width/2,-this.height/2,this.width,this.height),jsanvas.context.restore()};